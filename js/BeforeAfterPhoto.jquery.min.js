(function(e,t,n,r){function o(t,n){this.element=t;this.line=null,this.divisor=null,this.newDiv=null;this.options=e.extend({},s,n);this.options.orientation=this.options.orientation==="H"?this.options.orientation:"V";this._defaults=s;this._name=i;this.init()}function u(t,r){var i=e(t),s=e.extend({limitX:1e3,limitY:1e3,onMove:function(){},onDrop:function(){}},r),o={drag:function(e){var t=e.data.dragData,n=t.left+(e.pageX-t.offLeft)+t.limitMinX-t.hoverLeft,r=t.top+(e.pageY-t.offTop)+t.limitMinY-t.hoverTop,i={x:Math.min(t.limitMaxX,Math.max(0,n)),y:Math.min(t.limitMaxY,Math.max(0,r))};console.log(t,i);t.onMove(i)},drop:function(t){var r=t.data.dragData;r.onDrop(t);e(n).unbind("mousemove",o.drag).unbind("mouseup",o.drop)}};i.bind("mousedown",function(t){t.stopPropagation();var r=e(this);r.getCss=function(e){var t=parseInt(this.css(e),10);if(isNaN(t))return false;return t};var i={left:r.getCss("left")||0,top:r.getCss("top")||0,hoverLeft:t.layerX||t.offsetX||t.pageX-r.offset().left,hoverTop:t.layerY||t.offsetY||t.pageY-r.offset().top,offLeft:r.offset().left,offTop:r.offset().top,onMove:s.onMove,onDrop:s.onDrop,limitMinX:r.width()/2,limitMinY:r.height()/2,limitMaxX:s.limitX,limitMaxY:s.limitY,target:r};e(n).bind("mousemove",{dragData:i},o.drag).bind("mouseup",{dragData:i},o.drop)})}var i="BeforeAfterEffect",s={width:100,height:100,orientation:"H"};o.prototype={init:function(){var t=this,n=e(this.element),r=this.options.width,i=this.options.height,s=this.options.orientation,o=n.find("img").eq(0),a=n.find("img").eq(1),f=e('<span class="capA"></span>'),l=e('<span class="capB"></span>');this.line=e('<div class="lineDivisor"></div>');this.divisor=e('<div class="hoverDivisor'+s+'"></div>');this.newDiv=e("<div></div>");n.addClass("BeforeAfterEffect").width(r).height(i).append(l).append(this.newDiv).append(this.line).append(this.divisor);this.newDiv.append(o).append(f);f.html(o.attr("alt"));l.html(a.attr("alt"));if(s=="H"){this.line.height(i)}else{this.line.width(r);l.css("top",i-(l.height()+parseInt(l.css("top").replace("px",""),10)))}n.bind("mousedown",function(e){t.setPosition({x:e.pageX-n.offset().left,y:e.pageY-n.offset().top},true)});u(this.divisor,{limitX:r,limitY:i,onMove:e.proxy(this,"setPosition")});this.setPosition({y:i/2,x:r/2});this.divisor.attr("unselectable","on");n.attr("onselectstart","return false;")},setPosition:function(e,t){var n=500;if(this.options.orientation=="H"){e.y=this.options.height/2;e.xG=e.x;e.yG=e.y*2}else{e.x=this.options.width/2;e.xG=e.x*2;e.yG=e.y}if(t){this.newDiv.stop().animate({width:e.xG,height:e.yG},n);this.divisor.stop().animate({left:e.x-this.divisor.width()/2,top:e.y-this.divisor.height()/2},n);this.line.stop().animate({left:e.x-this.line.width()/2,top:e.y-this.line.height()/2},n)}else{this.newDiv.css({width:e.xG,height:e.yG});this.divisor.css({left:e.x-this.divisor.width()/2,top:e.y-this.divisor.height()/2});this.line.css({left:e.x-this.line.width()/2,top:e.y-this.line.height()/2})}}};e.fn[i]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+i)){e.data(this,"plugin_"+i,new o(this,t))}})}})(jQuery,window,document)